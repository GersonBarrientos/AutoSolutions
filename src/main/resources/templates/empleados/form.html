<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head th:replace="~{_layout :: head(~{::title})}">
  <title th:text="${empleado.id != null} ? 'Editar empleado · AutoSolutions' : 'Nuevo empleado · AutoSolutions'">Empleado</title>
</head>

<body th:replace="~{_layout :: layout(~{::title}, ~{::section})}">
<section>

  <!-- Header -->
  <div class="form-header">
    <div class="d-flex justify-content-between align-items-center">
      <div>
        <h1 class="form-title" th:text="${empleado.id != null} ? 'Editar Empleado' : 'Nuevo Empleado'">Empleado</h1>
        <p class="page-subtitle mt-1" th:text="${empleado.id != null} ? 'Actualiza la información del empleado' : 'Completa los datos del nuevo empleado'">
          Información del empleado
        </p>
      </div>
      <a class="btn btn-back" th:href="@{/empleados}">
        <i class="bi bi-arrow-left me-1"></i> Volver
      </a>
    </div>
  </div>

  <!-- Form -->
  <div class="form-card">
    <form th:action="${empleado.id == null} ? @{/empleados} : @{/empleados/{id}(id=${empleado.id})}"
          th:object="${empleado}" method="post">

      <!-- errores globales -->
      <div th:if="${#fields.hasGlobalErrors()}" class="alert alert-danger-minimal alert-dismissible fade show" role="alert">
        <div class="d-flex align-items-start">
          <i class="bi bi-exclamation-circle-fill me-2" style="font-size: 1.25rem;"></i>
          <div class="flex-grow-1">
            <strong class="d-block mb-1">No se pudo guardar</strong>
            <p th:each="err : ${#fields.globalErrors()}" th:text="${err}" class="mb-0 small">Error</p>
          </div>
        </div>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
      </div>

      <!-- hidden -->
      <input type="hidden" th:if="*{id != null}" th:field="*{id}">
      <input type="hidden" th:if="*{id != null}" th:field="*{version}">
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">

      <!-- sección: datos personales -->
      <div class="mb-4 pb-3" style="border-bottom: 1px solid var(--border-subtle);">
        <h6 class="text-uppercase" style="font-size: 0.8125rem; font-weight: 600; color: var(--gris-texto); letter-spacing: 0.05em;">
          <i class="bi bi-person-badge me-2"></i> Datos personales
        </h6>
      </div>

      <div class="row g-3">
        <div class="col-md-6">
          <label class="form-label-minimal">Nombre <span class="required">*</span></label>
          <input class="form-control form-control-minimal"
                 th:field="*{nombre}"
                 th:classappend="${#fields.hasErrors('nombre')} ? 'form-control-error' : ''"
                 placeholder="Ej: Ana Sofía">
          <small class="form-helper">Nombres del empleado</small>
          <span class="error-message" th:if="${#fields.hasErrors('nombre')}" th:errors="*{nombre}">Error</span>
        </div>

        <div class="col-md-6">
          <label class="form-label-minimal">Apellido <span class="required">*</span></label>
          <input class="form-control form-control-minimal"
                 th:field="*{apellido}"
                 th:classappend="${#fields.hasErrors('apellido')} ? 'form-control-error' : ''"
                 placeholder="Ej: Ramírez">
          <small class="form-helper">Apellidos del empleado</small>
          <span class="error-message" th:if="${#fields.hasErrors('apellido')}" th:errors="*{apellido}">Error</span>
        </div>
      </div>

      <!-- sección: contacto -->
      <div class="mb-4 pb-3 mt-4" style="border-bottom: 1px solid var(--border-subtle);">
        <h6 class="text-uppercase" style="font-size: 0.8125rem; font-weight: 600; color: var(--gris-texto); letter-spacing: 0.05em;">
          <i class="bi bi-telephone me-2"></i> Contacto
        </h6>
      </div>

      <div class="row g-3">
        <div class="col-md-6">
          <label class="form-label-minimal">Teléfono <span class="required">*</span></label>
          <input class="form-control form-control-minimal"
                 th:field="*{telefono}"
                 th:classappend="${#fields.hasErrors('telefono')} ? 'form-control-error' : ''"
                 placeholder="0000-0000">
          <small class="form-helper">Teléfono principal</small>
          <span class="error-message" th:if="${#fields.hasErrors('telefono')}" th:errors="*{telefono}">Error</span>
        </div>

        <div class="col-md-6">
          <label class="form-label-minimal">Correo</label>
          <input type="email" class="form-control form-control-minimal"
                 th:field="*{email}"
                 th:classappend="${#fields.hasErrors('email')} ? 'form-control-error' : ''"
                 placeholder="empleado@ejemplo.com">
          <small class="form-helper">Correo electrónico (opcional)</small>
          <span class="error-message" th:if="${#fields.hasErrors('email')}" th:errors="*{email}">Error</span>
        </div>
      </div>

      <!-- sección: laboral -->
      <div class="mb-4 pb-3 mt-4" style="border-bottom: 1px solid var(--border-subtle);">
        <h6 class="text-uppercase" style="font-size: 0.8125rem; font-weight: 600; color: var(--gris-texto); letter-spacing: 0.05em;">
          <i class="bi bi-briefcase me-2"></i> Información laboral
        </h6>
      </div>

      <div class="row g-3">
        <div class="col-md-6">
          <label class="form-label-minimal">Especialidad</label>
          <input class="form-control form-control-minimal"
                 th:field="*{especialidad}"
                 placeholder="Mecánico general, Electricista, etc.">
        </div>

        <div class="col-md-4">
          <label class="form-label-minimal">Fecha de ingreso <span class="required">*</span></label>
          <input type="date" class="form-control form-control-minimal"
                 th:field="*{fechaIngreso}"
                 th:classappend="${#fields.hasErrors('fechaIngreso')} ? 'form-control-error' : ''">
          <span class="error-message" th:if="${#fields.hasErrors('fechaIngreso')}" th:errors="*{fechaIngreso}">Error</span>
        </div>

        <div class="col-md-2 d-flex align-items-end">
          <div class="form-check">
            <input class="form-check-input" type="checkbox" th:field="*{activo}" id="activo">
            <label class="form-check-label" for="activo">Activo</label>
          </div>
        </div>
      </div>

      <!-- acciones -->
      <div class="form-actions">
        <button type="submit" class="btn btn-primary-form">
          <i class="bi bi-check-lg me-1"></i>
          <span th:text="${empleado.id != null} ? 'Actualizar Empleado' : 'Guardar Empleado'">Guardar</span>
        </button>
        <a class="btn btn-secondary-form" th:href="@{/empleados}">
          <i class="bi bi-x-lg me-1"></i> Cancelar
        </a>
      </div>
    </form>
  </div>

</section>
</body>
</html>
